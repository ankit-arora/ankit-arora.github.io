<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript">
        var clevertap = {event:[], profile:[], account:[], notifications:[]};
        clevertap.account.push({"id": "846-Z7Z-6K4Z"});
    </script>
    <link rel="manifest" href="./manifest.json">
</head>
<body>
<script type="text/javascript">
    (function () {
        var wzrk = document.createElement('script');
        wzrk.type = 'text/javascript';
        wzrk.async = true;
//        wzrk.src = ('https:' == document.location.protocol ? 'https://d2r1yp2w7bby2u.cloudfront.net' : 'http://static.clevertap.com') + '/js/a.js?v=0';
        wzrk.src = '/a.js?v=0';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wzrk, s);
    })();

    function iframesubscribe() {
        if(Notification.permission === "granted"){
            console.log("already registered");
            parent.postMessage(JSON.stringify({"state":"already"}),"*");
            return;
        }
        Notification.requestPermission(function (state) {
            console.log(state);
            parent.postMessage(JSON.stringify({"state":"granted"}),"*");
            window.open("https://google.com","_blank", "width=192, height=185");
//            navigator.serviceWorker.register('/clevertap_sw.js').then(
//                function(serviceWorkerRegistration) {
//                    debugger;
//                    serviceWorkerRegistration.pushManager.subscribe().then(
//                        function(pushSubscription) {
//                            console.log(pushSubscription.endpoint);
//                            // The push subscription details needed by the application
//                            // server are now available, and can be sent to it using,
//                            // for example, an XMLHttpRequest.
//                        }, function(error) {
//                            // During development it often helps to log errors to the
//                            // console. In a production environment it might make sense to
//                            // also report information about errors back to the
//                            // application server.
//                            console.log(error);
//                        }
//                    );
//                });
        });
    }
    iframesubscribe();

    //    clevertap.notifications.push({
    //
    //        "titleText":'Would you like to receive Push Notifications?',
    //        "bodyText":'We promise to only send you relevant content and give you updates on your transactions',
    //        "okButtonText":'Sign me up!',
    //        "rejectButtonText":'No thanks',
    //        "okButtonColor":'#f28046'
    //
    //    });

    console.log("test");
</script>
</body>
</html>